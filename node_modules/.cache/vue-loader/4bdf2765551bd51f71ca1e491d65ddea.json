{"remainingRequest":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\src\\views\\product\\Attr\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\src\\views\\product\\Attr\\index.vue","mtime":1662631992471},{"path":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662108539732},{"path":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\node_modules\\babel-loader\\lib\\index.js","mtime":1662108541364},{"path":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662108539732},{"path":"C:\\Users\\abcwu\\Desktop\\小黑\\Learn\\Gitee\\sgg_houtai\\node_modules\\vue-loader\\lib\\index.js","mtime":1662108544456}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyByZXFBZGRPclVwZGF0ZUF0dHIgfSBmcm9tICJAL2FwaS9wcm9kdWN0L2F0dHIiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiQXR0ciIsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGF0dHJMaXN0OiBbXSwNCiAgICAgIHNob3dUYWJsZTogdHJ1ZSwNCiAgICAgIGF0dHJOYW1lOiAiIiwNCiAgICAgIGlzQ2xpY2s6IHRydWUsDQogICAgICBhdHRyVmFsdWVMaXN0OiBbXSwNCiAgICAgIHZhbHVlTGlzdDogew0KICAgICAgICB2YWx1ZU5hbWU6ICIiLA0KICAgICAgICBhdHRySWQ6ICIiLA0KICAgICAgICBmbGFnOiBmYWxzZSwNCiAgICAgIH0sDQogICAgICBjYXRlZ29yeTNJZDogIiIsDQogICAgICBpZDogIiIsDQogICAgfTsNCiAgfSwNCiAgbW91bnRlZCgpIHt9LA0KICBtZXRob2RzOiB7DQogICAgLy8gaW5wdXTmoYblpLHljrvnhKbngrnml7YNCiAgICBpc0xvb2soaW5kZXgsIHJvdykgew0KICAgICAgaWYgKHJvdy52YWx1ZU5hbWUgPT0gIiIpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSgi5bGe5oCn5YC85LiN6IO95Li656m677yBIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLmF0dHJWYWx1ZUxpc3QubGVuZ3RoKSB7DQogICAgICAgIGxldCBpc1JlcGVhdCA9IHRoaXMuYXR0clZhbHVlTGlzdC5zb21lKChpdGVtKSA9PiB7DQogICAgICAgICAgaWYgKGl0ZW0gIT09IHJvdykgew0KICAgICAgICAgICAgcmV0dXJuIHJvdy52YWx1ZU5hbWUgPT0gaXRlbS52YWx1ZU5hbWU7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgaWYgKGlzUmVwZWF0KSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSgi5LiN6IO95LiO5bey5pyJ5bGe5oCn5YC86YeN5aSN77yBIik7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICB9DQogICAgICByb3cuZmxhZyA9IHRydWU7DQogICAgfSwNCiAgICAvLyDojrflj5bkuInnuqfliIbnsbtJZA0KICAgIGdldENhdGVnb3J5M0lkKHZhbHVlKSB7DQogICAgICB0aGlzLmNhdGVnb3J5M0lkID0gdmFsdWU7DQogICAgfSwNCiAgICAvLyDoh6rlrprkuYnkuovku7bnmoTlm57osIMNCiAgICBnZXRBdHRyTGlzdCh2YWx1ZSkgew0KICAgICAgdGhpcy5hdHRyTGlzdCA9IHZhbHVlOw0KICAgIH0sDQogICAgLy8g5re75Yqg5bGe5oCnDQogICAgYWRkQXR0cigpIHsNCiAgICAgIHRoaXMuc2hvd1RhYmxlID0gZmFsc2U7DQogICAgICB0aGlzLmlzQ2xpY2sgPSBmYWxzZTsNCiAgICB9LA0KICAgIC8vIOa3u+WKoOWxnuaAp+WAvA0KICAgIGFkZEF0dHJWYWx1ZSgpIHsNCiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudmFsdWVMaXN0KTsNCiAgICAgIC8vIHRoaXMudmFsdWVMaXN0LnZhbHVlTmFtZSA9ICcnOw0KICAgICAgdGhpcy5hdHRyVmFsdWVMaXN0LnB1c2goew0KICAgICAgICB2YWx1ZU5hbWU6ICIiLA0KICAgICAgICBhdHRySWQ6IHRoaXMudmFsdWVMaXN0LmFycklkLA0KICAgICAgICBmbGFnOiBmYWxzZSwNCiAgICAgIH0pOw0KICAgIH0sDQogICAgdXBkYXRlQXR0cihyb3cpIHsNCiAgICAgIHRoaXMuc2hvd1RhYmxlID0gZmFsc2U7DQogICAgICB0aGlzLmF0dHJOYW1lID0gcm93LmF0dHJOYW1lOw0KICAgICAgdGhpcy5pZCA9IHJvdy5pZDsNCiAgICAgIHRoaXMuYXR0clZhbHVlTGlzdCA9IFtdOw0KICAgICAgLy8gdGhpcy5hdHRyVmFsdWVMaXN0ID0gcm93LmF0dHJWYWx1ZUxpc3Q7DQogICAgICBmb3IgKGxldCBpdGVtIG9mIHJvdy5hdHRyVmFsdWVMaXN0KSB7DQogICAgICAgIGxldCB7IGF0dHJJZCwgdmFsdWVOYW1lIH0gPSBpdGVtOw0KICAgICAgICBsZXQgdmFsdWVSb3cgPSB7DQogICAgICAgICAgYXR0cklkLA0KICAgICAgICAgIHZhbHVlTmFtZSwNCiAgICAgICAgICBmbGFnOiB0cnVlLA0KICAgICAgICB9Ow0KICAgICAgICB0aGlzLmF0dHJWYWx1ZUxpc3QucHVzaCh2YWx1ZVJvdyk7DQogICAgICB9DQogICAgICB0aGlzLnZhbHVlTGlzdC5hdHRySWQgPSByb3cuaWQ7DQogICAgfSwNCiAgICAvLyDkv53lrZjmt7vliqDnmoTlsZ7mgKflgLwNCiAgICBzYXZlQXR0clZhbHVlKCkgew0KICAgICAgZm9yIChsZXQgaXRlbSBvZiB0aGlzLmF0dHJWYWx1ZUxpc3QpIHsNCiAgICAgICAgaWYgKGl0ZW0udmFsdWVOYW1lID09ICIiKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSgi5bGe5oCn5YC85LiN6IO95Li656m6Iik7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBsZXQgYmFzZUF0dHJJbmZvID0gew0KICAgICAgICBhdHRyTmFtZTogdGhpcy5hdHRyTmFtZSwNCiAgICAgICAgYXR0clZhbHVlTGlzdDogdGhpcy5hdHRyVmFsdWVMaXN0LA0KICAgICAgICBjYXRlZ29yeUlkOiB0aGlzLmNhdGVnb3J5M0lkLA0KICAgICAgICBjYXRlZ29yeUxldmVsOiAzLA0KICAgICAgICBpZDogdGhpcy5pZCwNCiAgICAgIH07DQogICAgICByZXFBZGRPclVwZGF0ZUF0dHIoYmFzZUF0dHJJbmZvKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHRoaXMuYXR0clZhbHVlTGlzdCkgew0KICAgICAgICAgICAgaXRlbS5mbGFnID0gdHJ1ZTsNCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy5zaG93VGFibGUgPSB0cnVlOw0KICAgICAgICAgIHRoaXMuJHJlZnMuQ2F0ZWdvcnlTZWxlY3QuZ2V0QXR0ckxpc3QoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBjYW5jZWwoKSB7DQogICAgICAvLyBpc0NsaWNrDQogICAgICB0aGlzLnNob3dUYWJsZSA9IHRydWU7DQogICAgICB0aGlzLmlzQ2xpY2sgPSB0cnVlOw0KICAgIH0sDQogICAgdG9FZGl0KGluZGV4LCByb3cpIHsNCiAgICAgIHJvdy5mbGFnID0gZmFsc2U7DQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnNbaW5kZXhdLmZvY3VzKCk7DQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product/Attr","sourcesContent":["<template>\r\n  <div>\r\n    <el-card style=\"margin: 20px 0px\">\r\n      <CategorySelect\r\n        @getAttrList=\"getAttrList\"\r\n        @getCategory3Id=\"getCategory3Id\"\r\n        :isClick.sync=\"isClick\"\r\n        ref=\"CategorySelect\"\r\n      ></CategorySelect>\r\n    </el-card>\r\n    <el-card>\r\n      <div v-show=\"showTable\">\r\n        <el-button\r\n          type=\"primary\"\r\n          icon=\"el-icon-plus\"\r\n          @click=\"addAttr\"\r\n          :disabled=\"!category3Id\"\r\n          >添加属性</el-button\r\n        >\r\n        <el-table :data=\"attrList\" style=\"width: 100%\" border>\r\n          <el-table-column type=\"index\" label=\"序号\" width=\"100px\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"attrName\" label=\"属性名称\" width=\"200px\">\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"attrValueList\"\r\n            label=\"属性值列表\"\r\n            width=\"width\"\r\n          >\r\n            <template slot-scope=\"{ row, $index }\">\r\n              <el-tag\r\n                type=\"success\"\r\n                v-for=\"(item, index) in row.attrValueList\"\r\n                :key=\"item.id\"\r\n                style=\"margin: 0 20px\"\r\n                >{{ item.valueName }}</el-tag\r\n              >\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"prop\" label=\"操作\" width=\"160px\">\r\n            <template slot-scope=\"{ row, $index }\">\r\n              <el-button\r\n                type=\"warning\"\r\n                icon=\"el-icon-edit\"\r\n                size=\"mini\"\r\n                @click=\"updateAttr(row)\"\r\n              ></el-button>\r\n              <el-button\r\n                type=\"danger\"\r\n                icon=\"el-icon-delete\"\r\n                size=\"mini\"\r\n              ></el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <div v-show=\"!showTable\">\r\n        <div style=\"margin: 20px 0\">\r\n          <span>属性名:</span>\r\n          <el-input\r\n            placeholder=\"请输入属性名\"\r\n            v-model=\"attrName\"\r\n            style=\"width: 350px; margin: 0 20px\"\r\n          ></el-input>\r\n        </div>\r\n        <div style=\"margin: 20px 0\">\r\n          <el-button\r\n            type=\"primary\"\r\n            icon=\"el-icon-plus\"\r\n            @click=\"addAttrValue\"\r\n            style=\"margin: 0 20px 0 0\"\r\n            :disabled=\"!attrName\"\r\n            >添加属性值</el-button\r\n          >\r\n          <el-button @click=\"cancel\">取消</el-button>\r\n        </div>\r\n\r\n        <el-table\r\n          :data=\"attrValueList\"\r\n          style=\"width: 100%; margin: 20px 0\"\r\n          border\r\n        >\r\n          <el-table-column type=\"index\" label=\"序号\" width=\"100px\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"attrName\" label=\"属性值名称\">\r\n            <template slot-scope=\"{ row, $index }\">\r\n              <span v-if=\"row.flag\" @click=\"toEdit($index, row)\">{{\r\n                row.valueName\r\n              }}</span>\r\n              <el-input\r\n                v-model=\"row.valueName\"\r\n                placeholder=\"请输入属性值名称\"\r\n                v-else\r\n                @blur=\"isLook($index, row)\"\r\n                @keyup.native.enter=\"toLook(row)\"\r\n                :ref=\"$index\"\r\n              ></el-input>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"prop\" label=\"操作\" width=\"160px\">\r\n            <template slot-scope=\"{ row, $index }\">\r\n              <el-button\r\n                type=\"danger\"\r\n                icon=\"el-icon-delete\"\r\n                size=\"mini\"\r\n              ></el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"saveAttrValue\"\r\n          :disabled=\"!attrValueList.length\"\r\n          >保存</el-button\r\n        >\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { reqAddOrUpdateAttr } from \"@/api/product/attr\";\r\nexport default {\r\n  name: \"Attr\",\r\n  data() {\r\n    return {\r\n      attrList: [],\r\n      showTable: true,\r\n      attrName: \"\",\r\n      isClick: true,\r\n      attrValueList: [],\r\n      valueList: {\r\n        valueName: \"\",\r\n        attrId: \"\",\r\n        flag: false,\r\n      },\r\n      category3Id: \"\",\r\n      id: \"\",\r\n    };\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    // input框失去焦点时\r\n    isLook(index, row) {\r\n      if (row.valueName == \"\") {\r\n        this.$message(\"属性值不能为空！\");\r\n        return;\r\n      }\r\n      if (this.attrValueList.length) {\r\n        let isRepeat = this.attrValueList.some((item) => {\r\n          if (item !== row) {\r\n            return row.valueName == item.valueName;\r\n          }\r\n        });\r\n        if (isRepeat) {\r\n          this.$message(\"不能与已有属性值重复！\");\r\n          return;\r\n        }\r\n      }\r\n      row.flag = true;\r\n    },\r\n    // 获取三级分类Id\r\n    getCategory3Id(value) {\r\n      this.category3Id = value;\r\n    },\r\n    // 自定义事件的回调\r\n    getAttrList(value) {\r\n      this.attrList = value;\r\n    },\r\n    // 添加属性\r\n    addAttr() {\r\n      this.showTable = false;\r\n      this.isClick = false;\r\n    },\r\n    // 添加属性值\r\n    addAttrValue() {\r\n      // console.log(this.valueList);\r\n      // this.valueList.valueName = '';\r\n      this.attrValueList.push({\r\n        valueName: \"\",\r\n        attrId: this.valueList.arrId,\r\n        flag: false,\r\n      });\r\n    },\r\n    updateAttr(row) {\r\n      this.showTable = false;\r\n      this.attrName = row.attrName;\r\n      this.id = row.id;\r\n      this.attrValueList = [];\r\n      // this.attrValueList = row.attrValueList;\r\n      for (let item of row.attrValueList) {\r\n        let { attrId, valueName } = item;\r\n        let valueRow = {\r\n          attrId,\r\n          valueName,\r\n          flag: true,\r\n        };\r\n        this.attrValueList.push(valueRow);\r\n      }\r\n      this.valueList.attrId = row.id;\r\n    },\r\n    // 保存添加的属性值\r\n    saveAttrValue() {\r\n      for (let item of this.attrValueList) {\r\n        if (item.valueName == \"\") {\r\n          this.$message(\"属性值不能为空\");\r\n          return;\r\n        }\r\n      }\r\n      let baseAttrInfo = {\r\n        attrName: this.attrName,\r\n        attrValueList: this.attrValueList,\r\n        categoryId: this.category3Id,\r\n        categoryLevel: 3,\r\n        id: this.id,\r\n      };\r\n      reqAddOrUpdateAttr(baseAttrInfo).then((res) => {\r\n        if (res.code === 200) {\r\n          for (let item of this.attrValueList) {\r\n            item.flag = true;\r\n          }\r\n          this.showTable = true;\r\n          this.$refs.CategorySelect.getAttrList();\r\n        }\r\n      });\r\n    },\r\n    cancel() {\r\n      // isClick\r\n      this.showTable = true;\r\n      this.isClick = true;\r\n    },\r\n    toEdit(index, row) {\r\n      row.flag = false;\r\n      this.$nextTick(() => {\r\n        this.$refs[index].focus();\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>"]}]}